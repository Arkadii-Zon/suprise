<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–ß—ë—Ç–∫–∏–π –º–æ–±–∏–ª—å–Ω—ã–π —Å—é—Ä–ø—Ä–∏–∑</title>
<style>
html, body {
  margin:0; padding:0; overflow:hidden; background:#050510;
  font-family:'Segoe UI',sans-serif;
}
canvas {
  display:block; position:absolute; top:0; left:0; z-index:1;
}
.center {
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  text-align:center; width:90%; z-index:10;
}
button {
  padding:12px 24px; font-size:16px;
  border-radius:30px; border:none; cursor:pointer; transition:0.3s;
}
.start-btn {
  background:linear-gradient(45deg,#ff7eb3,#ff758c);
  color:white; box-shadow:0 0 15px rgba(255,120,180,0.6);
}
.start-btn:hover {transform:scale(1.05);}
.heart-btn {
  margin-top:20px; font-size:50px; background:none;
  color:white; display:none;
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div class="center">
  <button id="startBtn" class="start-btn">–ù–∞–∂–º–∏, –µ—Å–ª–∏ –≥–æ—Ç–æ–≤–∞ ü§ç</button>
  <button id="heartBtn" class="heart-btn">ü§ç</button>
</div>

<script>
window.onload = function() {

const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let stars=[], particles=[], moleculeParticles=[], moleculeCenter={x:0,y:0}, isTextMode=false;

// ===== –ú–ê–°–®–¢–ê–ë –î–õ–Ø RETINA =====
const scale = window.devicePixelRatio || 1;

function resizeCanvas() {
  canvas.width = window.innerWidth * scale;
  canvas.height = window.innerHeight * scale;
  canvas.style.width = window.innerWidth + "px";
  canvas.style.height = window.innerHeight + "px";
  ctx.setTransform(1,0,0,1,0,0);
  ctx.scale(scale, scale);
  initStars();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// ===== –ó–í–Å–ó–î–´ =====
function initStars(){
  stars=[];
  for(let i=0;i<50;i++) stars.push({x:Math.random()*canvas.width/scale, y:Math.random()*canvas.height/scale, r:Math.random()*1.2, speed:Math.random()*0.15});
}
function drawStars(){
  stars.forEach(s=>{
    s.y += s.speed; if(s.y>canvas.height/scale) s.y=0;
    ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fillStyle='white'; ctx.fill();
  });
}

// ===== –ß–ê–°–¢–ò–¶–ê =====
class Particle{
  constructor(x,y,color='#ff7eb3'){
    this.x=x; this.y=y; this.tx=x; this.ty=y; 
    this.size=1.5;
    this.color=color;
  }
  update(){ this.x+=(this.tx-this.x)*0.08; this.y+=(this.ty-this.y)*0.08; }
  draw(ctx){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle=this.color;
    ctx.shadowColor=this.color;
    ctx.shadowBlur=4;
    ctx.fill();
    ctx.shadowBlur=0;
  }
}

// ===== –°–ï–†–î–¶–ï =====
function createHeartsParticles(){
  particles=[];
  const cx=canvas.width/scale/2, cy=canvas.height/scale/2;
  const total=300;
  for(let i=0;i<total;i++){
    const t=Math.random()*Math.PI*2;
    const r=Math.random()*15+5;
    const x=cx+16*Math.pow(Math.sin(t),3)*r;
    const y=cy-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))*r;
    const shade=200+Math.random()*55;
    particles.push(new Particle(x+(Math.random()-0.5)*2, y+(Math.random()-0.5)*2, `rgb(255,${shade},200)`));
  }
}

// ===== –¢–ï–ö–°–¢ =====
const textLines=["–°–æ—Å–∫—É—á–∏–ª—Å—è –ø–æ —Ç–≤–æ–µ–π —É–ª—ã–±–∫–µ, –õ–µ–¥–∏","ame de mon ame"];
function createTextFromParticles(){
  isTextMode=true;

  const offCanvas=document.createElement('canvas');
  offCanvas.width=canvas.width;
  offCanvas.height=canvas.height;
  const offCtx=offCanvas.getContext('2d');

  offCtx.fillStyle='white';
  offCtx.textAlign='center';
  offCtx.textBaseline='middle';

  const fontSize = Math.floor(canvas.width/scale / 12);
  offCtx.font=`bold ${fontSize}px Segoe UI`;

  const totalHeight = textLines.length * fontSize * 1.6;
  const startY = canvas.height/scale/2 - totalHeight/2 + fontSize/2;

  textLines.forEach((line,i)=>offCtx.fillText(line, canvas.width/scale/2, startY+i*fontSize*1.6));

  const imgData = offCtx.getImageData(0,0,offCanvas.width,offCanvas.height).data;
  let positions=[];
  const step = 2; // —à–∞–≥ 2px ‚Äî —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —á—ë—Ç–∫–æ—Å—Ç—å—é –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —á–∞—Å—Ç–∏—Ü
  for(let y=0;y<canvas.height/scale;y+=step){
    for(let x=0;x<canvas.width/scale;x+=step){
      if(imgData[(y*offCanvas.width + x)*4+3]>128){
        positions.push({x,y});
      }
    }
  }

  particles = [];
  for(let i=0;i<positions.length;i++){
    const pos = positions[i];
    const p = new Particle(Math.random()*canvas.width/scale, Math.random()*canvas.height/scale,"#ff7eb3");
    p.tx = pos.x; p.ty = pos.y;
    particles.push(p);
  }

  setTimeout(initMolecule,800);
}

// ===== –ú–û–õ–ï–ö–£–õ–ê =====
function initMolecule(){
  moleculeCenter={x:canvas.width/scale/2, y:canvas.height/scale/2-100};
  moleculeParticles=[
    {angle:0,radius:40,speed:0.02,size:4,color:'#ffde59'},
    {angle:0,radius:65,speed:0.015,size:4,color:'#ff595e'},
    {angle:0,radius:90,speed:0.01,size:4,color:'#59ffde'}
  ];
}
function drawMolecule(){
  if(!moleculeParticles.length) return;
  ctx.beginPath();
  ctx.arc(moleculeCenter.x, moleculeCenter.y, 8, 0, Math.PI*2);
  ctx.fillStyle='white'; ctx.fill();
  ctx.shadowColor='white'; ctx.shadowBlur=8; ctx.fill(); ctx.shadowBlur=0;
  moleculeParticles.forEach(p=>{
    p.angle+=p.speed;
    const x=moleculeCenter.x+p.radius*Math.cos(p.angle);
    const y=moleculeCenter.y+p.radius*Math.sin(p.angle);
    ctx.beginPath();
    ctx.arc(x,y,p.size,0,Math.PI*2);
    ctx.fillStyle=p.color; ctx.shadowColor=p.color; ctx.shadowBlur=6; ctx.fill(); ctx.shadowBlur=0;

    ctx.beginPath();
    ctx.arc(moleculeCenter.x, moleculeCenter.y, p.radius, 0, Math.PI*2);
    ctx.strokeStyle='rgba(255,255,255,0.1)'; ctx.stroke();
  });
}

// ===== –ê–ù–ò–ú–ê–¶–ò–Ø =====
function animate(){
  ctx.clearRect(0,0,canvas.width/scale,canvas.height/scale);
  drawStars();
  particles.forEach(p=>p.update());
  particles.forEach(p=>p.draw(ctx));
  drawMolecule();
  requestAnimationFrame(animate);
}
animate();

// ===== –ö–ù–û–ü–ö–ò =====
document.getElementById('startBtn').onclick=()=>{
  createHeartsParticles();
  document.getElementById('startBtn').style.display='none';
  setTimeout(()=>{document.getElementById('heartBtn').style.display='inline';},800);
};
document.getElementById('heartBtn').onclick=()=>{
  document.getElementById('heartBtn').style.display='none';
  createTextFromParticles();
};

} // window.onload
</script>
</body>
</html>
